# rog.io

## Название проекта: rog.io

## Описание игры

**rog.io** — это динамичный 2D-шутер с видом сверху в жанре арена-рогалик, разработанный с использованием библиотеки Pygame. Игроку предстоит сражаться с волнами врагов, перемещаясь по арене, уворачиваясь от атак и используя свои уникальные способности.

### Механики игры:

*   **Выбор персонажа:** В начале игры можно выбрать один из двух типов персонажей:
    *   **"Strong" (Сильный):** Высокий урон, но низкая скорость атаки.
    *   **"Fast" (Быстрый):** Низкий урон, но высокая скорость атаки.
*   **Перемещение:** Игрок управляет персонажем с помощью клавиш WASD или стрелок.
*   **Автоматическая атака:** Персонаж автоматически атакует ближайшего врага в пределах своей дальности атаки.
*   **Система волн:** Враги появляются волнами, каждая последующая волна становится сложнее, увеличивая количество противников. Цель игры — выжить максимальное количество волн.
*   **Препятствия:** На арене случайным образом генерируются препятствия, которые влияют на перемещение игрока и врагов.
*   **Система опыта и уровней:** За уничтожение врагов игрок получает опыт. При накоплении достаточного количества опыта персонаж повышает уровень, что увеличивает его урон и скорость передвижения. *Важно: максимальное здоровье персонажа и его регенерация при повышении уровня отсутствуют, что делает игру более сложной и требует стратегического подхода к выживанию.*
*   **Звуковые эффекты:** Игра сопровождается звуками выстрелов, попаданий и нажатий кнопок.
*   **Настройки:** В главном меню доступны настройки громкости музыки и звуковых эффектов.

### Цель игры:

Основная цель — выжить как можно дольше, уничтожая волны врагов, набирая очки и повышая уровень своего персонажа.

## Как запустить игру

Для запуска игры вам потребуется установленный Python 3.x и библиотека Pygame.

1.  **Установка зависимостей (если не установлены):**
    Откройте терминал или командную строку и выполните команду:
    ```bash
    pip install pygame
    ```
    Или если выдает ошибку выполните команду:
    ```bash
    poetry install
    ```

2.  **Запуск игры:**
    Перейдите в корневую директорию проекта (`PYGAME_2K/`) в терминале и выполните:
    ```bash
    python main.py
    ```
    Или если выдает ошибку выполните команду:
    ```bash
    poetry run python main.py
    ```

### Управление:

*   **Перемещение:** При помощи стрелок
*   **Пауза/Возобновить:** `ESC`
*   **Навигация по меню:** Мышь (нажатия кнопок)

## Что было сделано и использовано

### Используемые технологии:

*   **Python 3.x:** Основной язык программирования.
*   **Pygame:** Кроссплатформенная библиотека для разработки 2D-игр на Python.
*   **Pygame Mixer:** Модуль Pygame для работы со звуком и музыкой.

### Алгоритмы и механики:

*   **Обнаружение столкновений:**
    *   Реализовано обнаружение столкновений между игроком/врагами и препятствиями (прямоугольник-круг).
    *   Обнаружение столкновений между снарядами и врагами (круг-круг).
*   **Скользящее столкновение (Sliding Collision Response):**
    *   Внедрен алгоритм, позволяющий игроку и врагам "скользить" вдоль препятствий, если прямое движение заблокировано, вместо полного застревания. Это улучшает плавность перемещения в условиях ограниченного пространства.
*   **Система спрайтов:**
    *   Загрузка и масштабирование спрайтов `hero.png` (для игрока) и `enemy.png` (для врагов) под размеры их хитбоксов.
    *   Динамический поворот спрайта игрока в сторону ближайшего врага.
    *   Динамический поворот спрайтов врагов в сторону следующей точки на их пути к игроку.
*   **Система уровней и характеристик:**
    *   Игрок получает опыт за уничтожение врагов.
    *   При повышении уровня увеличиваются урон и скорость передвижения персонажа.
    *   *Особое внимание:* Удалено увеличение максимального здоровья и регенерация здоровья при повышении уровня, что делает игру более сложной и фокусирует на избегании урона.
*   **Управление громкостью:**
    *   Реализованы ползунки громкости для музыки и звуковых эффектов в меню настроек. Громкость звуковых эффектов масштабируется относительно их исходных значений.

### Проблемы, с которыми столкнулся и их решения:

*   **Враги не появляются после первой волны:**
    *   **Причина:** Условие для начала следующей волны было слишком строгим, требуя, чтобы `enemies_to_spawn` был *точно равен нулю*, что не всегда происходило, если некоторые враги не могли заспавниться.
    *   **Решение:** Изменение условия на `enemies_to_spawn <= 0`, а также добавление механизма нескольких попыток спавна врага в `Game.spawn_enemy` с последующим уменьшением счетчика, даже если место не найдено, чтобы волна не застряла.
*   **Проблемы с инкапсуляцией и глобальными переменными:**
    *   **Причина:** Использование глобальных переменных для шрифтов и прямая зависимость классов от объекта `Game` для загрузки спрайтов нарушали принципы DRY и SOLID.
    *   **Решение:** Передача объектов шрифтов в конструкторы кнопок, а спрайтов — в конструкторы `Player` и `Enemy`, что улучшило инкапсуляцию и модульность кода.
